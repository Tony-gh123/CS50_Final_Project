{% extends 'main/land.html' %}

{% block title %}PDF Helper | Chat{% endblock %}

{% block content %}
    {% if conversation %}
        <!-- Chat -->
        <h1>Chat</h1>
        <ul>
            {% for recipient, messages in conversation.items %}
                <li>
                    <a href="{% url 'conversation' recipient.id}">
                        {{ recipient.username }}
                    </a>
                    {% if messages %}
                        - Last message: {{ messages.last.content }} ({{ messages.last.timestamp}})
                    {% else %}
                        - No Messages
                    {% endif %}
                </li>
            {% endfor %}
        </ul>
    {% else %}
        <p>No conversations</p>
    {% endif %}

    {% if view == 'send' %}
    <!-- Send Messages -->
        
        <h1>Send Message</h1>
        <form method="post">
            {% csrf_token %}
            <textarea name="content" placeholder="Type Here"></textarea>
            <button type="submit">Send</button>
        </form>
    {% endif %}

    {% if view == 'conversation' %}
    <!-- Conversation log -->
        <h1>Conversation</h1>
        {% if messages %}
            <ul>
                {% for message in messages %}
                    <li>{{ message.content }} - {{ message.timestamp }}</li>
                {% endfor %}
            </ul>
        {% else %}
            <p>No messages yet</p>
        {% endif %}
    {% endif %}

{% endblock %}